<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>TrueTrend AI - Learn it. Earn it. Own it.</title>
<meta name="description" content="TrueTrend AI reads your charts, explains the why, and alerts you with clear entries. Works with any chart or platform." />
<style>
  :root{
    --bg:#0b1220;--card:#0f172a;--border:#1f2937;--text:#e6e9ef;--muted:#9aa3b2;
    --accent:#22c55e;--ink:#031c10;--btn:#16a34a;--btn2:#0ea5e9;--danger:#ef4444;--warn:#f59e0b
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial}
  a{color:inherit;text-decoration:none}
  .container{max-width:1140px;margin:0 auto;padding:0 16px}
  header{position:sticky;top:0;background:rgba(11,18,32,.75);backdrop-filter:blur(10px);border-bottom:1px solid var(--border);z-index:5}
  .nav{height:64px;display:flex;align-items:center;justify-content:space-between}
  .brand{font-weight:800}
  .nav a{margin-left:14px;opacity:.95}
  .cta{background:var(--accent);color:var(--ink);border:1px solid var(--accent);padding:10px 14px;border-radius:10px;font-weight:800}
  .ghost{border:1px solid var(--border);padding:10px 14px;border-radius:10px}
  .outline{border:1px solid var(--border);padding:10px 14px;border-radius:10px}
  .hero{padding:40px 0 28px;border-bottom:1px solid var(--border)}
  h1{margin:0 0 10px;font-size:40px;line-height:1.15}
  .tag{color:var(--muted)}
  .btns{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
  .grid2{display:grid;grid-template-columns:1.1fr .9fr;gap:20px}
  .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:14px}
  .badges{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
  .badge{border:1px solid var(--border);border-radius:999px;padding:6px 10px;color:var(--muted);background:#0b1424;font-size:13px}
  .section{padding:34px 0;border-bottom:1px solid var(--border)}
  h2{margin:0 0 12px}
  .input, select{height:40px;border:1px solid var(--border);border-radius:10px;background:#0b1220;color:var(--text);padding:0 10px}
  button{height:40px;border-radius:10px;border:1px solid var(--border);background:var(--btn);color:#03120a;padding:0 16px;font-weight:800;cursor:pointer}
  button.secondary{background:#0b1220;color:var(--text)}
  pre{white-space:pre-wrap;margin:10px 0 0}
  .small{color:var(--muted);font-size:13px}
  .row{display:flex;gap:8px;flex-wrap:wrap}
  .plans{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px}
  .plan{background:#0b1424;border:1px solid var(--border);border-radius:14px;padding:16px}
  .price{font-size:26px;font-weight:900;margin:6px 0 10px}
  .pill{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--border);border-radius:999px;padding:6px 10px;background:#0b1424}
  .dot{width:10px;height:10px;border-radius:50%}
  .green{background:var(--accent)} .yellow{background:var(--warn)} .red{background:var(--danger)}
  @media (max-width:900px){ .grid2{grid-template-columns:1fr} h1{font-size:32px} }
</style>
</head>
<body>
<header>
  <div class="container nav">
    <div class="brand">TrueTrend AI</div>
    <nav>
      <a href="#how">How it works</a>
      <a href="#strategies">Strategies</a>
      <a href="#custom">Custom</a>
      <a href="#voice">Voice</a>
      <a href="#pricing" class="ghost">Pricing</a>
      <a class="cta" target="_blank" rel="noopener" href="https://buy.stripe.com/3cI7sLfiJ33efHDdcO38400">Start Free Trial</a>
    </nav>
  </div>
</header>

<section class="hero">
  <div class="container grid2">
    <div>
      <h1>Your AI co-pilot for markets and money</h1>
      <p class="tag"><b>Learn your money. Earn your money. Own your money.</b> TrueTrend reads your charts, explains the why, and alerts you with clear entries. Works with any chart or platform.</p>
      <div class="btns">
        <a class="cta" target="_blank" rel="noopener" href="https://buy.stripe.com/3cI7sLfiJ33efHDdcO38400">Start Free Trial</a>
        <a class="ghost" href="#strategies">See Strategies and How-To</a>
        <a class="outline" href="/api/analyze" target="_blank" rel="noopener">Try Live Demo</a>
      </div>
      <div class="badges">
        <span class="badge">TradingView</span><span class="badge">Schwab</span><span class="badge">Fidelity</span>
        <span class="badge">TD</span><span class="badge">Webull</span><span class="badge">MooMoo</span>
        <span class="badge">PocketOptions</span><span class="badge">Binance</span><span class="badge">MT4/5</span>
      </div>
    </div>

    <div class="card">
      <h3 style="margin:0 0 6px">Try it live</h3>
      <p class="small">Example: NVDA, AAPL, SPY, OANDA:EUR_USD, BINANCE:BTCUSDT</p>
      <div class="row">
        <input id="symbol" class="input" placeholder="AAPL" value="NVDA" style="flex:1">
        <select id="tf">
          <option>Monthly</option><option selected>Weekly</option>
          <option>Daily</option><option>1h</option><option>15m</option>
        </select>
        <button id="go">Analyze</button>
      </div>
      <pre id="out"></pre>

      <div class="card" style="margin-top:10px">
        <h4 style="margin:0 0 6px">Overtrading Guard</h4>
        <div class="row">
          <span class="pill"><span id="ogLight" class="dot green"></span><span id="ogStatus">Cool</span></span>
          <span class="small">Counts Analyze clicks to help you pace. Local only.</span>
        </div>
        <div class="row" style="margin-top:8px">
          <label class="small">15m limit <input id="og15" type="number" class="input" value="10" style="width:80px;margin-left:6px"></label>
          <label class="small">60m limit <input id="og60" type="number" class="input" value="25" style="width:80px;margin-left:6px"></label>
          <label class="small">Cooldown min <input id="ogCd" type="number" class="input" value="0" style="width:80px;margin-left:6px"></label>
          <button id="ogReset" class="secondary">Reset</button>
        </div>
        <div id="ogCounts" class="small" style="margin-top:6px"></div>
      </div>
    </div>
  </div>
</section>

<section id="how" class="section">
  <div class="container grid2">
    <div>
      <h2>How it works</h2>
      <p class="small">TrueTrend detects bias, momentum and key levels, then gives you entries with confidence. Use it with any chart by mirroring the rules on your platform.</p>
      <ul class="small" style="line-height:1.6;margin:6px 0 0;padding-left:18px">
        <li>Live bias, confidence, RSI and levels</li>
        <li>Strategy presets including Trendline, EMA Pullback, RSI plus MACD</li>
        <li>Stocks, forex, crypto, indices and more</li>
      </ul>
    </div>
    <div class="card">
      <h3 style="margin:0 0 6px">Alexa quick start (Pro)</h3>
      <ol class="small" style="line-height:1.6;margin:6px 0 0">
        <li>Enable the TrueTrend skill in your Alexa app</li>
        <li>Say: Alexa, ask TrueTrend what is the direction on NVDA</li>
        <li>Ask for confidence, RSI and key levels</li>
      </ol>
      <a class="outline" href="#voice" style="display:inline-block;margin-top:8px">Voice instructions</a>
    </div>
  </div>
</section>

<section id="strategies" class="section">
  <div class="container">
    <h2>Strategies and how to implement</h2>
    <div class="card" style="margin-top:8px">
      <h3 style="margin:0 0 6px">Trendline Strategy</h3>
      <ul class="small" style="line-height:1.6;margin:6px 0 0;padding-left:18px">
        <li>Draw a line through two or more swing lows for an uptrend or highs for a downtrend</li>
        <li>Entry A - bounce: price touches and rejects in the direction of the trend</li>
        <li>Entry B - break: strong close through the line then retest then continuation</li>
        <li>Stops beyond the line or swing, targets 1R to 2R or next support or resistance</li>
        <li>Best on 5m to 1h charts for stocks, forex or crypto</li>
      </ul>
    </div>
    <div class="row" style="margin-top:10px">
      <a class="ghost" href="#custom">Open Custom Strategy Runner</a>
      <a class="cta" target="_blank" rel="noopener" href="https://buy.stripe.com/3cI7sLfiJ33efHDdcO38400">Start Free Trial</a>
    </div>
  </div>
</section>

<section id="custom" class="section">
  <div class="container">
    <h2>Custom Strategy - JSON</h2>
    <p class="small">Paste a simple strategy object and run it on live data. Fields: name, rules[]. Each rule: ind, param, op, right, tf, req.</p>
    <div class="card">
      <textarea id="stratBox" style="width:100%;min-height:140px;border:1px solid var(--border);border-radius:10px;background:#0b1220;color:var(--text);padding:10px">
{
  "name": "Trendline helper",
  "baseTF": "15m",
  "rules": [
    { "ind": "Price", "op": "touches", "right": "Trendline(2+ touches)", "tf": "15m", "req": true },
    { "ind": "RSI", "param": 14, "op": ">", "right": "50", "tf": "15m", "req": false }
  ]
}
      </textarea>
      <div class="row" style="margin-top:8px">
        <input id="sym2" class="input" placeholder="AAPL" value="AAPL" style="flex:1">
        <select id="tf2"><option>15m</option><option>1h</option><option>4h</option><option>Daily</option></select>
        <button id="runStrat">Run on live data</button>
      </div>
      <pre id="stratOut"></pre>
    </div>
  </div>
</section>

<section id="voice" class="section">
  <div class="container">
    <h2>Voice test</h2>
    <div class="card">
      <div class="row">
        <input id="vsym" class="input" placeholder="AAPL or OANDA:EUR_USD" style="flex:1">
        <select id="vtf"><option>15m</option><option>1h</option><option>Daily</option></select>
        <button id="vbtn" class="secondary">Get voice text</button>
      </div>
      <pre id="vout"></pre>
    </div>
  </div>
</section>

<section id="pricing" class="section">
  <div class="container">
    <h2>Pricing</h2>
    <p class="small">Every plan includes a 3 day free trial. Cancel anytime.</p>
    <div class="plans" style="margin-top:8px">
      <div class="plan">
        <h3>Basic</h3>
        <div class="price">$59.99 per month</div>
        <ul class="small" style="line-height:1.6;margin:6px 0 0;padding-left:18px">
          <li>Core strategy engine and daily insights</li>
          <li>Live bias, confidence, RSI and levels</li>
          <li>Works on any chart or platform</li>
        </ul>
        <a class="cta" target="_blank" rel="noopener" href="https://buy.stripe.com/fZueVd0nPgU4dzvfkW38401" style="display:inline-block;margin-top:10px">Start Free Trial</a>
      </div>
      <div class="plan">
        <h3>Advanced</h3>
        <div class="price">$99.99 per month</div>
        <ul class="small" style="line-height:1.6;margin:6px 0 0;padding-left:18px">
          <li>Everything in Basic</li>
          <li>Advanced strategies and sector heatmaps</li>
          <li>Strategy presets and backtests</li>
        </ul>
        <a class="cta" target="_blank" rel="noopener" href="https://buy.stripe.com/3cI7sLfiJ33efHDdcO38400" style="display:inline-block;margin-top:10px">Start Free Trial</a>
      </div>
      <div class="plan">
        <h3>Pro Lifetime</h3>
        <div class="price">$999 one time</div>
        <ul class="small" style="line-height:1.6;margin:6px 0 0;padding-left:18px">
          <li>Everything in Advanced</li>
          <li>Alexa voice integration</li>
          <li>Priority updates and support</li>
        </ul>
        <a class="cta" target="_blank" rel="noopener" href="https://buy.stripe.com/bJe00jfiJ7ju3YVdcO38406" style="display:inline-block;margin-top:10px">Start 3 Day Trial</a>
      </div>
    </div>
  </div>
</section>

<footer class="section" style="border-bottom:none">
  <div class="container small">Copyright <span id="y"></span> TrueTrend AI - Learn it. Earn it. Own it.</div>
</footer>

<script>
  // tiny helpers
  function $(id){return document.getElementById(id);}
  function j(r){return JSON.stringify(r,null,2);}

  // Overtrading guard (local only)
  const ogKey = "tt_clicks";
  function readClicks(){ try{return JSON.parse(localStorage.getItem(ogKey)||"[]");}catch(e){return []} }
  function writeClicks(a){ localStorage.setItem(ogKey, JSON.stringify(a)); }
  function updateGuardUI(){
    const now = Date.now();
    const arr = readClicks().filter(t => now - t < 60*60*1000);
    writeClicks(arr);
    const n15 = arr.filter(t => now - t < 15*60*1000).length;
    const n60 = arr.length;
    const lim15 = parseInt($("og15").value||"10",10);
    const lim60 = parseInt($("og60").value||"25",10);
    $("ogCounts").textContent = "Last 15m: " + n15 + "/" + lim15 + " - Last 60m: " + n60 + "/" + lim60;

    var cls = "green", txt = "Cool";
    if (n15 >= lim15 || n60 >= lim60){ cls = "red"; txt = "Slow down"; }
    else if (n15 >= Math.max(1, Math.floor(lim15*0.7)) || n60 >= Math.max(1, Math.floor(lim60*0.7))){ cls="yellow"; txt="Caution"; }
    $("ogLight").className = "dot " + cls;
    $("ogStatus").textContent = txt;

    const cdMin = parseInt($("ogCd").value||"0",10);
    const until = parseInt(localStorage.getItem("tt_cd_until")||"0",10);
    const nowSec = Math.floor(now/1000);
    const cooling = nowSec < until;
    $("go").disabled = cooling;
    $("go").textContent = cooling ? ("Cooldown " + Math.ceil((until-nowSec)/60) + "m") : "Analyze";

    if (!cooling && cdMin>0 && (n15 >= lim15 || n60 >= lim60)){
      localStorage.setItem("tt_cd_until", String(nowSec + cdMin*60));
      updateGuardUI();
    }
  }
  ["og15","og60","ogCd"].forEach(id => $(id).addEventListener("input", updateGuardUI));
  $("ogReset").addEventListener("click", ()=>{ writeClicks([]); localStorage.removeItem("tt_cd_until"); updateGuardUI(); });

  // Analyze
  async function run(symbol, timeframe, payloadExtra){
    const body = Object.assign({symbol,timeframe}, (payloadExtra||{}));
    const r = await fetch("/api/analyze", {
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body: JSON.stringify(body)
    });
    const ct = r.headers.get("content-type")||"";
    const data = ct.indexOf("application/json")>=0 ? await r.json() : { raw: await r.text() };
    if (!r.ok || data.error){ throw new Error(data.message || JSON.stringify(data.detail) || data.raw || ("HTTP "+r.status)); }
    return data;
  }

  $("go").addEventListener("click", async ()=>{
    const s = ($("symbol").value||"AAPL").trim();
    const tf = $("tf").value || "Weekly";
    $("out").textContent = "Analyzing...";
    try{
      const data = await run(s, tf);
      const q = data.quote||{};
      const sig = data.signal||{};
      var lines = [];
      lines.push("Symbol: " + s + " (" + tf + ")");
      lines.push("Price: " + q.c + "  Open: " + q.o + "  High: " + q.h + "  Low: " + q.l);
      if (q.pc!=null && q.c!=null){
        var d = q.c - q.pc, p = q.pc ? (d/q.pc*100) : 0;
        lines.push("Change: " + d.toFixed(2) + " (" + p.toFixed(2) + "%)");
      }
      lines.push("");
      lines.push("Signal: " + (sig.action||"-") + "  Confidence: " + (sig.confidence!=null?sig.confidence:"-") + "%");
      lines.push("Entry: " + (sig.entry!=null?sig.entry:"-") + "  Stop: " + (sig.stop!=null?sig.stop:"-"));
      lines.push("Targets: " + (Array.isArray(sig.targets)?sig.targets.join(", "):"-"));
      $("out").textContent = lines.join("\n");

      const arr = readClicks(); arr.push(Date.now()); writeClicks(arr); updateGuardUI();
    }catch(e){
      $("out").textContent = "Error: " + e.message;
    }
  });

  // Custom strategy
  $("runStrat").addEventListener("click", async ()=>{
    var sObj;
    try{ sObj = JSON.parse($("stratBox").value); }catch(e){ $("stratOut").textContent = "Invalid JSON"; return; }
    const sym = $("sym2").value.trim() || "AAPL";
    const tfx = $("tf2").value || "15m";
    $("stratOut").textContent = "Running custom strategy...";
    try{
      const data = await run(sym, tfx, { strategy:sObj, mode:"signal" });
      $("stratOut").textContent = j(data.signal||data);
    }catch(e){ $("stratOut").textContent = "Error: " + e.message; }
  });

  // Voice test
  $("vbtn").addEventListener("click", async ()=>{
    const s = $("vsym").value.trim() || "AAPL";
    const tf = $("vtf").value || "15m";
    $("vout").textContent = "Requesting...";
    try{
      const data = await run(s, tf, { mode:"voice" });
      $("vout").textContent = data.speech || j(data);
    }catch(e){ $("vout").textContent = "Error: " + e.message; }
  });

  // init
  document.getElementById("y").textContent = new Date().getFullYear();
  updateGuardUI();
</script>
</body>
</html>
